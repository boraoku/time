class TimeParser
  # City disambiguation for same-named cities in different countries
  CITY_COUNTRY_DISAMBIGUATION = {
    'san jose (costa rica)' => 'Central America',
    'san jose (usa)' => 'Pacific Time (US & Canada)',
    "st john's (canada)" => 'Newfoundland',
    "st john's (antigua)" => 'Atlantic Time (Canada)',
    'naples (italy)' => 'Rome',
    'naples (usa)' => 'Eastern Time (US & Canada)',
    'birmingham (uk)' => 'London',
    'birmingham (usa)' => 'Central Time (US & Canada)',
    'st petersburg (russia)' => 'Moscow',
    'st petersburg (usa)' => 'Eastern Time (US & Canada)',
    'reading (uk)' => 'London',
    'reading (usa)' => 'Eastern Time (US & Canada)'
  }.freeze

  CITY_TIMEZONE_MAP = {
    # Oceania & Pacific
    'sydney' => 'Sydney',
    'melbourne' => 'Melbourne',
    'brisbane' => 'Brisbane',
    'perth' => 'Perth',
    'adelaide' => 'Adelaide',
    'hobart' => 'Hobart',
    'darwin' => 'Darwin',
    'canberra' => 'Sydney',
    'auckland' => 'Auckland',
    'wellington' => 'Wellington',
    'christchurch' => 'Auckland',
    'fiji' => 'Fiji',
    'suva' => 'Fiji',
    'port moresby' => 'Port Moresby',
    'honiara' => 'Solomon Is.',
    'noumea' => 'New Caledonia',
    'papeete' => 'Tahiti',
    'honolulu' => 'Hawaii',
    'guam' => 'Guam',
    'samoa' => 'Samoa',
    'midway' => 'Midway Island',
    
    # East Asia
    'tokyo' => 'Tokyo',
    'osaka' => 'Osaka',
    'kyoto' => 'Tokyo',
    'nagoya' => 'Tokyo',
    'sapporo' => 'Tokyo',
    'yokohama' => 'Tokyo',
    'seoul' => 'Seoul',
    'busan' => 'Seoul',
    'beijing' => 'Beijing',
    'shanghai' => 'Beijing',
    'guangzhou' => 'Beijing',
    'shenzhen' => 'Beijing',
    'chengdu' => 'Beijing',
    'wuhan' => 'Beijing',
    'tianjin' => 'Beijing',
    'hong kong' => 'Hong Kong',
    'hongkong' => 'Hong Kong',
    'macau' => 'Hong Kong',
    'taipei' => 'Taipei',
    'manila' => 'Asia/Manila',
    'cebu' => 'Asia/Manila',
    'vladivostok' => 'Vladivostok',
    'ulaanbaatar' => 'Ulaanbaatar',
    
    # Southeast Asia
    'singapore' => 'Singapore',
    'kuala lumpur' => 'Kuala Lumpur',
    'kl' => 'Kuala Lumpur',
    'jakarta' => 'Jakarta',
    'bali' => 'Jakarta',
    'bangkok' => 'Bangkok',
    'phuket' => 'Bangkok',
    'hanoi' => 'Hanoi',
    'ho chi minh' => 'Hanoi',
    'saigon' => 'Hanoi',
    'phnom penh' => 'Bangkok',
    'vientiane' => 'Bangkok',
    'yangon' => 'Rangoon',
    'rangoon' => 'Rangoon',
    'bandar seri begawan' => 'Asia/Brunei',
    
    # South Asia
    'delhi' => 'New Delhi',
    'new delhi' => 'New Delhi',
    'mumbai' => 'Mumbai',
    'bombay' => 'Mumbai',
    'bangalore' => 'Kolkata',
    'bengaluru' => 'Kolkata',
    'kolkata' => 'Kolkata',
    'calcutta' => 'Kolkata',
    'chennai' => 'Chennai',
    'madras' => 'Chennai',
    'hyderabad' => 'Kolkata',
    'pune' => 'Mumbai',
    'ahmedabad' => 'Mumbai',
    'dhaka' => 'Dhaka',
    'karachi' => 'Karachi',
    'lahore' => 'Karachi',
    'islamabad' => 'Karachi',
    'colombo' => 'Colombo',
    'kathmandu' => 'Kathmandu',
    'male' => 'Maldives',
    'kabul' => 'Kabul',
    
    # Middle East
    'dubai' => 'Asia/Dubai',
    'abu dhabi' => 'Abu Dhabi',
    'doha' => 'Asia/Qatar',
    'kuwait' => 'Kuwait',
    'kuwait city' => 'Kuwait',
    'riyadh' => 'Riyadh',
    'jeddah' => 'Riyadh',
    'mecca' => 'Riyadh',
    'medina' => 'Riyadh',
    'muscat' => 'Muscat',
    'manama' => 'Asia/Bahrain',
    'beirut' => 'Asia/Beirut',
    'damascus' => 'Asia/Damascus',
    'amman' => 'Asia/Amman',
    'jerusalem' => 'Jerusalem',
    'tel aviv' => 'Jerusalem',
    'baghdad' => 'Baghdad',
    'tehran' => 'Tehran',
    'yerevan' => 'Yerevan',
    'baku' => 'Baku',
    'tbilisi' => 'Tbilisi',
    'ankara' => 'Istanbul',
    'istanbul' => 'Istanbul',
    'nicosia' => 'Nicosia',
    
    # Africa
    'cairo' => 'Cairo',
    'alexandria' => 'Cairo',
    'johannesburg' => 'Johannesburg',
    'cape town' => 'Cape Town',
    'durban' => 'Johannesburg',
    'pretoria' => 'Johannesburg',
    'lagos' => 'Lagos',
    'abuja' => 'Lagos',
    'kinshasa' => 'West Central Africa',
    'nairobi' => 'Nairobi',
    'addis ababa' => 'Nairobi',
    'dar es salaam' => 'Nairobi',
    'kampala' => 'Nairobi',
    'khartoum' => 'Nairobi',
    'algiers' => 'Algiers',
    'tunis' => 'Tunis',
    'casablanca' => 'Casablanca',
    'rabat' => 'Casablanca',
    'marrakech' => 'Casablanca',
    'tripoli' => 'Tripoli',
    'accra' => 'Monrovia',
    'dakar' => 'Monrovia',
    'abidjan' => 'Monrovia',
    'maputo' => 'Maputo',
    'harare' => 'Harare',
    'lusaka' => 'Harare',
    'windhoek' => 'Windhoek',
    'gaborone' => 'Harare',
    'antananarivo' => 'Nairobi',
    'port louis' => 'Port Louis',
    
    # Europe
    'london' => 'London',
    'manchester' => 'London',
    'birmingham' => 'London',
    'glasgow' => 'London',
    'edinburgh' => 'Edinburgh',
    'belfast' => 'London',
    'cardiff' => 'London',
    'dublin' => 'Dublin',
    'cork' => 'Dublin',
    'paris' => 'Paris',
    'lyon' => 'Paris',
    'marseille' => 'Paris',
    'nice' => 'Paris',
    'bordeaux' => 'Paris',
    'berlin' => 'Berlin',
    'munich' => 'Berlin',
    'frankfurt' => 'Berlin',
    'hamburg' => 'Berlin',
    'cologne' => 'Berlin',
    'stuttgart' => 'Berlin',
    'dusseldorf' => 'Berlin',
    'madrid' => 'Madrid',
    'barcelona' => 'Madrid',
    'valencia' => 'Madrid',
    'seville' => 'Madrid',
    'malaga' => 'Madrid',
    'bilbao' => 'Madrid',
    'lisbon' => 'Lisbon',
    'porto' => 'Lisbon',
    'rome' => 'Rome',
    'milan' => 'Rome',
    'naples' => 'Rome',
    'turin' => 'Rome',
    'venice' => 'Rome',
    'florence' => 'Rome',
    'amsterdam' => 'Amsterdam',
    'rotterdam' => 'Amsterdam',
    'the hague' => 'Amsterdam',
    'brussels' => 'Brussels',
    'antwerp' => 'Brussels',
    'vienna' => 'Vienna',
    'zurich' => 'Zurich',
    'geneva' => 'Zurich',
    'bern' => 'Bern',
    'basel' => 'Zurich',
    'copenhagen' => 'Copenhagen',
    'stockholm' => 'Stockholm',
    'oslo' => 'Oslo',
    'helsinki' => 'Helsinki',
    'reykjavik' => 'Atlantic/Reykjavik',
    'athens' => 'Athens',
    'warsaw' => 'Warsaw',
    'krakow' => 'Warsaw',
    'prague' => 'Prague',
    'budapest' => 'Budapest',
    'bucharest' => 'Bucharest',
    'sofia' => 'Sofia',
    'belgrade' => 'Belgrade',
    'zagreb' => 'Zagreb',
    'ljubljana' => 'Ljubljana',
    'sarajevo' => 'Sarajevo',
    'skopje' => 'Skopje',
    'tirana' => 'Europe/Tirane',
    'tallinn' => 'Tallinn',
    'riga' => 'Riga',
    'vilnius' => 'Vilnius',
    'minsk' => 'Minsk',
    'kiev' => 'Kyiv',
    'kyiv' => 'Kyiv',
    'moscow' => 'Moscow',
    'st petersburg' => 'Moscow',
    'novosibirsk' => 'Novosibirsk',
    'yekaterinburg' => 'Yekaterinburg',
    'monaco' => 'Paris',
    'vatican city' => 'Rome',
    'san marino' => 'Rome',
    'andorra' => 'Madrid',
    'luxembourg' => 'Brussels',
    'vaduz' => 'Zurich',
    'valletta' => 'Europe/Malta',
    
    # North America
    'new york' => 'Eastern Time (US & Canada)',
    'nyc' => 'Eastern Time (US & Canada)',
    'boston' => 'Eastern Time (US & Canada)',
    'philadelphia' => 'Eastern Time (US & Canada)',
    'washington' => 'Eastern Time (US & Canada)',
    'washington dc' => 'Eastern Time (US & Canada)',
    'baltimore' => 'Eastern Time (US & Canada)',
    'miami' => 'Eastern Time (US & Canada)',
    'orlando' => 'Eastern Time (US & Canada)',
    'atlanta' => 'Eastern Time (US & Canada)',
    'charlotte' => 'Eastern Time (US & Canada)',
    'detroit' => 'Eastern Time (US & Canada)',
    'cleveland' => 'Eastern Time (US & Canada)',
    'pittsburgh' => 'Eastern Time (US & Canada)',
    'buffalo' => 'Eastern Time (US & Canada)',
    'chicago' => 'Central Time (US & Canada)',
    'houston' => 'Central Time (US & Canada)',
    'dallas' => 'Central Time (US & Canada)',
    'san antonio' => 'Central Time (US & Canada)',
    'austin' => 'Central Time (US & Canada)',
    'memphis' => 'Central Time (US & Canada)',
    'nashville' => 'Central Time (US & Canada)',
    'new orleans' => 'Central Time (US & Canada)',
    'milwaukee' => 'Central Time (US & Canada)',
    'minneapolis' => 'Central Time (US & Canada)',
    'st louis' => 'Central Time (US & Canada)',
    'kansas city' => 'Central Time (US & Canada)',
    'denver' => 'Mountain Time (US & Canada)',
    'salt lake city' => 'Mountain Time (US & Canada)',
    'albuquerque' => 'Mountain Time (US & Canada)',
    'phoenix' => 'Arizona',
    'tucson' => 'Arizona',
    'las vegas' => 'Pacific Time (US & Canada)',
    'los angeles' => 'Pacific Time (US & Canada)',
    'la' => 'Pacific Time (US & Canada)',
    'san francisco' => 'Pacific Time (US & Canada)',
    'sf' => 'Pacific Time (US & Canada)',
    'san diego' => 'Pacific Time (US & Canada)',
    'seattle' => 'Pacific Time (US & Canada)',
    'portland' => 'Pacific Time (US & Canada)',
    'sacramento' => 'Pacific Time (US & Canada)',
    'oakland' => 'Pacific Time (US & Canada)',
    'anchorage' => 'Alaska',
    'fairbanks' => 'Alaska',
    'juneau' => 'Alaska',
    
    # Canada
    'toronto' => 'Eastern Time (US & Canada)',
    'montreal' => 'Eastern Time (US & Canada)',
    'ottawa' => 'Eastern Time (US & Canada)',
    'quebec city' => 'Eastern Time (US & Canada)',
    'vancouver' => 'Pacific Time (US & Canada)',
    'calgary' => 'Mountain Time (US & Canada)',
    'edmonton' => 'Mountain Time (US & Canada)',
    'winnipeg' => 'Central Time (US & Canada)',
    'halifax' => 'Atlantic Time (Canada)',
    "st john's" => 'Newfoundland',
    'regina' => 'Saskatchewan',
    'saskatoon' => 'Saskatchewan',
    'whitehorse' => 'Pacific Time (US & Canada)',
    'yellowknife' => 'Mountain Time (US & Canada)',
    'iqaluit' => 'Eastern Time (US & Canada)',
    
    # Central & South America
    'mexico city' => 'Mexico City',
    'guadalajara' => 'Guadalajara',
    'monterrey' => 'Monterrey',
    'cancun' => 'Eastern Time (US & Canada)',
    'tijuana' => 'Tijuana',
    'havana' => 'Havana',
    'santo domingo' => 'Atlantic Time (Canada)',
    'san juan' => 'Atlantic Time (Canada)',
    'kingston' => 'Eastern Time (US & Canada)',
    'panama city' => 'Central America',
    'san jose' => 'Central America',
    'guatemala city' => 'Central America',
    'san salvador' => 'Central America',
    'tegucigalpa' => 'Central America',
    'managua' => 'Central America',
    'belize city' => 'Central America',
    'bogota' => 'Bogota',
    'medellin' => 'Bogota',
    'cali' => 'Bogota',
    'caracas' => 'Caracas',
    'lima' => 'Lima',
    'quito' => 'Quito',
    'guayaquil' => 'Quito',
    'la paz' => 'La Paz',
    'sucre' => 'La Paz',
    'santiago' => 'Santiago',
    'valparaiso' => 'Santiago',
    'buenos aires' => 'Buenos Aires',
    'cordoba' => 'Buenos Aires',
    'rosario' => 'Buenos Aires',
    'mendoza' => 'Buenos Aires',
    'montevideo' => 'Montevideo',
    'asuncion' => 'Asuncion',
    'sao paulo' => 'Brasilia',
    'rio de janeiro' => 'Brasilia',
    'rio' => 'Brasilia',
    'brasilia' => 'Brasilia',
    'salvador' => 'Brasilia',
    'fortaleza' => 'Brasilia',
    'belo horizonte' => 'Brasilia',
    'manaus' => 'Manaus',
    'porto alegre' => 'Brasilia',
    'recife' => 'Brasilia',
    'curitiba' => 'Brasilia',
    'georgetown' => 'Georgetown',
    'paramaribo' => 'America/Paramaribo',
    'cayenne' => 'Cayenne',
    'stanley' => 'Atlantic/Stanley',
    
    # Caribbean
    'nassau' => 'Eastern Time (US & Canada)',
    'bridgetown' => 'Atlantic Time (Canada)',
    'port of spain' => 'Atlantic Time (Canada)',
    'port-au-prince' => 'Eastern Time (US & Canada)',
    'castries' => 'Atlantic Time (Canada)',
    'basseterre' => 'Atlantic Time (Canada)',
    'roseau' => 'Atlantic Time (Canada)',
    "st george's" => 'Atlantic Time (Canada)',
    'oranjestad' => 'Atlantic Time (Canada)',
    'willemstad' => 'Atlantic Time (Canada)',
    'philipsburg' => 'Atlantic Time (Canada)',
    'fort-de-france' => 'Atlantic Time (Canada)',
    'pointe-a-pitre' => 'Atlantic Time (Canada)',
    'basse-terre' => 'Atlantic Time (Canada)',
    'marigot' => 'Atlantic Time (Canada)',
    'gustavia' => 'Atlantic Time (Canada)',
    'the valley' => 'Atlantic Time (Canada)',
    'road town' => 'Atlantic Time (Canada)',
    'charlotte amalie' => 'Atlantic Time (Canada)',
    'hamilton' => 'Atlantic Time (Canada)',
    'george town' => 'Eastern Time (US & Canada)',
    
    # Additional US Cities & Towns
    'tampa' => 'Eastern Time (US & Canada)',
    'jacksonville' => 'Eastern Time (US & Canada)',
    'fort lauderdale' => 'Eastern Time (US & Canada)',
    'west palm beach' => 'Eastern Time (US & Canada)',
    'savannah' => 'Eastern Time (US & Canada)',
    'charleston' => 'Eastern Time (US & Canada)',
    'columbia' => 'Eastern Time (US & Canada)',
    'raleigh' => 'Eastern Time (US & Canada)',
    'durham' => 'Eastern Time (US & Canada)',
    'greensboro' => 'Eastern Time (US & Canada)',
    'winston-salem' => 'Eastern Time (US & Canada)',
    'richmond' => 'Eastern Time (US & Canada)',
    'norfolk' => 'Eastern Time (US & Canada)',
    'virginia beach' => 'Eastern Time (US & Canada)',
    'indianapolis' => 'Eastern Time (US & Canada)',
    'columbus' => 'Eastern Time (US & Canada)',
    'cincinnati' => 'Eastern Time (US & Canada)',
    'louisville' => 'Eastern Time (US & Canada)',
    'lexington' => 'Eastern Time (US & Canada)',
    'knoxville' => 'Eastern Time (US & Canada)',
    'chattanooga' => 'Eastern Time (US & Canada)',
    'providence' => 'Eastern Time (US & Canada)',
    'hartford' => 'Eastern Time (US & Canada)',
    'new haven' => 'Eastern Time (US & Canada)',
    'stamford' => 'Eastern Time (US & Canada)',
    'bridgeport' => 'Eastern Time (US & Canada)',
    'albany' => 'Eastern Time (US & Canada)',
    'syracuse' => 'Eastern Time (US & Canada)',
    'rochester' => 'Eastern Time (US & Canada)',
    'yonkers' => 'Eastern Time (US & Canada)',
    'newark' => 'Eastern Time (US & Canada)',
    'jersey city' => 'Eastern Time (US & Canada)',
    'paterson' => 'Eastern Time (US & Canada)',
    'elizabeth' => 'Eastern Time (US & Canada)',
    'trenton' => 'Eastern Time (US & Canada)',
    'camden' => 'Eastern Time (US & Canada)',
    'wilmington' => 'Eastern Time (US & Canada)',
    'dover' => 'Eastern Time (US & Canada)',
    'annapolis' => 'Eastern Time (US & Canada)',
    'harrisburg' => 'Eastern Time (US & Canada)',
    'allentown' => 'Eastern Time (US & Canada)',
    'scranton' => 'Eastern Time (US & Canada)',
    'erie' => 'Eastern Time (US & Canada)',
    'lancaster' => 'Eastern Time (US & Canada)',
    'york' => 'Eastern Time (US & Canada)',
    'akron' => 'Eastern Time (US & Canada)',
    'dayton' => 'Eastern Time (US & Canada)',
    'toledo' => 'Eastern Time (US & Canada)',
    'youngstown' => 'Eastern Time (US & Canada)',
    'canton' => 'Eastern Time (US & Canada)',
    'lansing' => 'Eastern Time (US & Canada)',
    'grand rapids' => 'Eastern Time (US & Canada)',
    'flint' => 'Eastern Time (US & Canada)',
    'ann arbor' => 'Eastern Time (US & Canada)',
    'kalamazoo' => 'Eastern Time (US & Canada)',
    'green bay' => 'Central Time (US & Canada)',
    'madison' => 'Central Time (US & Canada)',
    'des moines' => 'Central Time (US & Canada)',
    'cedar rapids' => 'Central Time (US & Canada)',
    'davenport' => 'Central Time (US & Canada)',
    'sioux city' => 'Central Time (US & Canada)',
    'omaha' => 'Central Time (US & Canada)',
    'lincoln' => 'Central Time (US & Canada)',
    'wichita' => 'Central Time (US & Canada)',
    'topeka' => 'Central Time (US & Canada)',
    'little rock' => 'Central Time (US & Canada)',
    'fort smith' => 'Central Time (US & Canada)',
    'fayetteville' => 'Central Time (US & Canada)',
    'springfield mo' => 'Central Time (US & Canada)',
    'columbia mo' => 'Central Time (US & Canada)',
    'jefferson city' => 'Central Time (US & Canada)',
    'tulsa' => 'Central Time (US & Canada)',
    'oklahoma city' => 'Central Time (US & Canada)',
    'norman' => 'Central Time (US & Canada)',
    'fort worth' => 'Central Time (US & Canada)',
    'arlington tx' => 'Central Time (US & Canada)',
    'plano' => 'Central Time (US & Canada)',
    'irving' => 'Central Time (US & Canada)',
    'garland' => 'Central Time (US & Canada)',
    'lubbock' => 'Central Time (US & Canada)',
    'amarillo' => 'Central Time (US & Canada)',
    'el paso' => 'Mountain Time (US & Canada)',
    'corpus christi' => 'Central Time (US & Canada)',
    'brownsville' => 'Central Time (US & Canada)',
    'laredo' => 'Central Time (US & Canada)',
    'beaumont' => 'Central Time (US & Canada)',
    'baton rouge' => 'Central Time (US & Canada)',
    'shreveport' => 'Central Time (US & Canada)',
    'lafayette' => 'Central Time (US & Canada)',
    'jackson' => 'Central Time (US & Canada)',
    'gulfport' => 'Central Time (US & Canada)',
    'mobile' => 'Central Time (US & Canada)',
    'montgomery' => 'Central Time (US & Canada)',
    'huntsville' => 'Central Time (US & Canada)',
    'tuscaloosa' => 'Central Time (US & Canada)',
    'pensacola' => 'Central Time (US & Canada)',
    'tallahassee' => 'Eastern Time (US & Canada)',
    'gainesville' => 'Eastern Time (US & Canada)',
    'clearwater' => 'Eastern Time (US & Canada)',
    'cape coral' => 'Eastern Time (US & Canada)',
    'fort myers' => 'Eastern Time (US & Canada)',
    'sarasota' => 'Eastern Time (US & Canada)',
    'lakeland' => 'Eastern Time (US & Canada)',
    'palm bay' => 'Eastern Time (US & Canada)',
    'melbourne fl' => 'Eastern Time (US & Canada)',
    'daytona beach' => 'Eastern Time (US & Canada)',
    'colorado springs' => 'Mountain Time (US & Canada)',
    'aurora co' => 'Mountain Time (US & Canada)',
    'fort collins' => 'Mountain Time (US & Canada)',
    'boulder' => 'Mountain Time (US & Canada)',
    'greeley' => 'Mountain Time (US & Canada)',
    'pueblo' => 'Mountain Time (US & Canada)',
    'cheyenne' => 'Mountain Time (US & Canada)',
    'casper' => 'Mountain Time (US & Canada)',
    'laramie' => 'Mountain Time (US & Canada)',
    'billings' => 'Mountain Time (US & Canada)',
    'missoula' => 'Mountain Time (US & Canada)',
    'great falls' => 'Mountain Time (US & Canada)',
    'bozeman' => 'Mountain Time (US & Canada)',
    'helena' => 'Mountain Time (US & Canada)',
    'bismarck' => 'Central Time (US & Canada)',
    'fargo' => 'Central Time (US & Canada)',
    'grand forks' => 'Central Time (US & Canada)',
    'rapid city' => 'Mountain Time (US & Canada)',
    'sioux falls' => 'Central Time (US & Canada)',
    'santa fe' => 'Mountain Time (US & Canada)',
    'las cruces' => 'Mountain Time (US & Canada)',
    'scottsdale' => 'Arizona',
    'mesa' => 'Arizona',
    'glendale az' => 'Arizona',
    'chandler' => 'Arizona',
    'tempe' => 'Arizona',
    'peoria az' => 'Arizona',
    'surprise' => 'Arizona',
    'yuma' => 'Arizona',
    'flagstaff' => 'Arizona',
    'prescott' => 'Arizona',
    'boise' => 'Mountain Time (US & Canada)',
    'nampa' => 'Mountain Time (US & Canada)',
    'meridian' => 'Mountain Time (US & Canada)',
    'idaho falls' => 'Mountain Time (US & Canada)',
    'pocatello' => 'Mountain Time (US & Canada)',
    'provo' => 'Mountain Time (US & Canada)',
    'west valley city' => 'Mountain Time (US & Canada)',
    'west jordan' => 'Mountain Time (US & Canada)',
    'orem' => 'Mountain Time (US & Canada)',
    'ogden' => 'Mountain Time (US & Canada)',
    'st george' => 'Mountain Time (US & Canada)',
    'reno' => 'Pacific Time (US & Canada)',
    'henderson' => 'Pacific Time (US & Canada)',
    'north las vegas' => 'Pacific Time (US & Canada)',
    'sparks' => 'Pacific Time (US & Canada)',
    'carson city' => 'Pacific Time (US & Canada)',
    'long beach' => 'Pacific Time (US & Canada)',
    'anaheim' => 'Pacific Time (US & Canada)',
    'santa ana' => 'Pacific Time (US & Canada)',
    'irvine' => 'Pacific Time (US & Canada)',
    'chula vista' => 'Pacific Time (US & Canada)',
    'fremont' => 'Pacific Time (US & Canada)',
    'santa rosa' => 'Pacific Time (US & Canada)',
    'hayward' => 'Pacific Time (US & Canada)',
    'sunnyvale' => 'Pacific Time (US & Canada)',
    'santa clara' => 'Pacific Time (US & Canada)',
    'vallejo' => 'Pacific Time (US & Canada)',
    'berkeley' => 'Pacific Time (US & Canada)',
    'fairfield' => 'Pacific Time (US & Canada)',
    'richmond ca' => 'Pacific Time (US & Canada)',
    'daly city' => 'Pacific Time (US & Canada)',
    'san mateo' => 'Pacific Time (US & Canada)',
    'san leandro' => 'Pacific Time (US & Canada)',
    'livermore' => 'Pacific Time (US & Canada)',
    'redwood city' => 'Pacific Time (US & Canada)',
    'mountain view' => 'Pacific Time (US & Canada)',
    'palo alto' => 'Pacific Time (US & Canada)',
    'cupertino' => 'Pacific Time (US & Canada)',
    'milpitas' => 'Pacific Time (US & Canada)',
    'santa cruz' => 'Pacific Time (US & Canada)',
    'salinas' => 'Pacific Time (US & Canada)',
    'monterey' => 'Pacific Time (US & Canada)',
    'fresno' => 'Pacific Time (US & Canada)',
    'modesto' => 'Pacific Time (US & Canada)',
    'stockton' => 'Pacific Time (US & Canada)',
    'bakersfield' => 'Pacific Time (US & Canada)',
    'riverside' => 'Pacific Time (US & Canada)',
    'san bernardino' => 'Pacific Time (US & Canada)',
    'ontario ca' => 'Pacific Time (US & Canada)',
    'oxnard' => 'Pacific Time (US & Canada)',
    'thousand oaks' => 'Pacific Time (US & Canada)',
    'ventura' => 'Pacific Time (US & Canada)',
    'santa barbara' => 'Pacific Time (US & Canada)',
    'pasadena' => 'Pacific Time (US & Canada)',
    'glendale ca' => 'Pacific Time (US & Canada)',
    'burbank' => 'Pacific Time (US & Canada)',
    'santa monica' => 'Pacific Time (US & Canada)',
    'beverly hills' => 'Pacific Time (US & Canada)',
    'west hollywood' => 'Pacific Time (US & Canada)',
    'culver city' => 'Pacific Time (US & Canada)',
    'inglewood' => 'Pacific Time (US & Canada)',
    'torrance' => 'Pacific Time (US & Canada)',
    'pomona' => 'Pacific Time (US & Canada)',
    'norwalk' => 'Pacific Time (US & Canada)',
    'downey' => 'Pacific Time (US & Canada)',
    'fullerton' => 'Pacific Time (US & Canada)',
    'orange' => 'Pacific Time (US & Canada)',
    'costa mesa' => 'Pacific Time (US & Canada)',
    'huntington beach' => 'Pacific Time (US & Canada)',
    'garden grove' => 'Pacific Time (US & Canada)',
    'oceanside' => 'Pacific Time (US & Canada)',
    'escondido' => 'Pacific Time (US & Canada)',
    'carlsbad' => 'Pacific Time (US & Canada)',
    'vista' => 'Pacific Time (US & Canada)',
    'tacoma' => 'Pacific Time (US & Canada)',
    'spokane' => 'Pacific Time (US & Canada)',
    'bellevue' => 'Pacific Time (US & Canada)',
    'everett' => 'Pacific Time (US & Canada)',
    'kent' => 'Pacific Time (US & Canada)',
    'renton' => 'Pacific Time (US & Canada)',
    'federal way' => 'Pacific Time (US & Canada)',
    'yakima' => 'Pacific Time (US & Canada)',
    'bellingham' => 'Pacific Time (US & Canada)',
    'olympia' => 'Pacific Time (US & Canada)',
    'salem' => 'Pacific Time (US & Canada)',
    'eugene' => 'Pacific Time (US & Canada)',
    'gresham' => 'Pacific Time (US & Canada)',
    'hillsboro' => 'Pacific Time (US & Canada)',
    'beaverton' => 'Pacific Time (US & Canada)',
    'bend' => 'Pacific Time (US & Canada)',
    'medford' => 'Pacific Time (US & Canada)',
    'springfield or' => 'Pacific Time (US & Canada)',
    'corvallis' => 'Pacific Time (US & Canada)',
    
    # Additional Canadian Cities
    'victoria' => 'Pacific Time (US & Canada)',
    'surrey' => 'Pacific Time (US & Canada)',
    'burnaby' => 'Pacific Time (US & Canada)',
    'richmond bc' => 'Pacific Time (US & Canada)',
    'kelowna' => 'Pacific Time (US & Canada)',
    'kamloops' => 'Pacific Time (US & Canada)',
    'prince george' => 'Pacific Time (US & Canada)',
    'nanaimo' => 'Pacific Time (US & Canada)',
    'red deer' => 'Mountain Time (US & Canada)',
    'lethbridge' => 'Mountain Time (US & Canada)',
    'medicine hat' => 'Mountain Time (US & Canada)',
    'fort mcmurray' => 'Mountain Time (US & Canada)',
    'brandon' => 'Central Time (US & Canada)',
    'thunder bay' => 'Eastern Time (US & Canada)',
    'sudbury' => 'Eastern Time (US & Canada)',
    'sault ste marie' => 'Eastern Time (US & Canada)',
    'barrie' => 'Eastern Time (US & Canada)',
    'guelph' => 'Eastern Time (US & Canada)',
    'hamilton on' => 'Eastern Time (US & Canada)',
    'kitchener' => 'Eastern Time (US & Canada)',
    'waterloo' => 'Eastern Time (US & Canada)',
    'cambridge on' => 'Eastern Time (US & Canada)',
    'london on' => 'Eastern Time (US & Canada)',
    'windsor' => 'Eastern Time (US & Canada)',
    'oshawa' => 'Eastern Time (US & Canada)',
    'mississauga' => 'Eastern Time (US & Canada)',
    'brampton' => 'Eastern Time (US & Canada)',
    'markham' => 'Eastern Time (US & Canada)',
    'vaughan' => 'Eastern Time (US & Canada)',
    'richmond hill' => 'Eastern Time (US & Canada)',
    'oakville' => 'Eastern Time (US & Canada)',
    'burlington on' => 'Eastern Time (US & Canada)',
    'kingston on' => 'Eastern Time (US & Canada)',
    'peterborough' => 'Eastern Time (US & Canada)',
    'niagara falls' => 'Eastern Time (US & Canada)',
    'belleville' => 'Eastern Time (US & Canada)',
    'sarnia' => 'Eastern Time (US & Canada)',
    'chatham' => 'Eastern Time (US & Canada)',
    'laval' => 'Eastern Time (US & Canada)',
    'longueuil' => 'Eastern Time (US & Canada)',
    'gatineau' => 'Eastern Time (US & Canada)',
    'sherbrooke' => 'Eastern Time (US & Canada)',
    'trois-rivieres' => 'Eastern Time (US & Canada)',
    'saguenay' => 'Eastern Time (US & Canada)',
    'levis' => 'Eastern Time (US & Canada)',
    'terrebonne' => 'Eastern Time (US & Canada)',
    'saint john' => 'Atlantic Time (Canada)',
    'moncton' => 'Atlantic Time (Canada)',
    'fredericton' => 'Atlantic Time (Canada)',
    'charlottetown' => 'Atlantic Time (Canada)',
    'dartmouth' => 'Atlantic Time (Canada)',
    'sydney ns' => 'Atlantic Time (Canada)',
    'glace bay' => 'Atlantic Time (Canada)',
    
    # Additional UK Cities
    'leeds' => 'London',
    'sheffield' => 'London',
    'bristol' => 'London',
    'liverpool' => 'London',
    'newcastle' => 'London',
    'nottingham' => 'London',
    'southampton' => 'London',
    'portsmouth' => 'London',
    'leicester' => 'London',
    'coventry' => 'London',
    'bradford' => 'London',
    'stoke' => 'London',
    'wolverhampton' => 'London',
    'plymouth' => 'London',
    'derby' => 'London',
    'swansea' => 'London',
    'reading' => 'London',
    'northampton' => 'London',
    'luton' => 'London',
    'warrington' => 'London',
    'dudley' => 'London',
    'york uk' => 'London',
    'bath' => 'London',
    'cambridge uk' => 'London',
    'oxford' => 'London',
    'brighton' => 'London',
    'bournemouth' => 'London',
    'norwich' => 'London',
    'swindon' => 'London',
    'southend' => 'London',
    'middlesbrough' => 'London',
    'peterborough uk' => 'London',
    'blackpool' => 'London',
    'preston' => 'London',
    'aberdeen' => 'London',
    'dundee' => 'London',
    'paisley' => 'London',
    'stirling' => 'London',
    'inverness' => 'London',
    'perth uk' => 'London',
    'galway' => 'Dublin',
    'limerick' => 'Dublin',
    'waterford' => 'Dublin',
    
    # Additional European Cities
    'toulouse' => 'Paris',
    'nantes' => 'Paris',
    'strasbourg' => 'Paris',
    'montpellier' => 'Paris',
    'lille' => 'Paris',
    'rennes' => 'Paris',
    'reims' => 'Paris',
    'toulon' => 'Paris',
    'grenoble' => 'Paris',
    'dijon' => 'Paris',
    'angers' => 'Paris',
    'nimes' => 'Paris',
    'cannes' => 'Paris',
    'bonn' => 'Berlin',
    'mannheim' => 'Berlin',
    'karlsruhe' => 'Berlin',
    'wiesbaden' => 'Berlin',
    'munster' => 'Berlin',
    'augsburg' => 'Berlin',
    'aachen' => 'Berlin',
    'bielefeld' => 'Berlin',
    'bochum' => 'Berlin',
    'wuppertal' => 'Berlin',
    'dresden' => 'Berlin',
    'leipzig' => 'Berlin',
    'hannover' => 'Berlin',
    'nuremberg' => 'Berlin',
    'duisburg' => 'Berlin',
    'essen' => 'Berlin',
    'dortmund' => 'Berlin',
    'bremen' => 'Berlin',
    'freiburg' => 'Berlin',
    'heidelberg' => 'Berlin',
    'mainz' => 'Berlin',
    'kiel' => 'Berlin',
    'lubeck' => 'Berlin',
    'rostock' => 'Berlin',
    'potsdam' => 'Berlin',
    'zaragoza' => 'Madrid',
    'palma' => 'Madrid',
    'murcia' => 'Madrid',
    'las palmas' => 'Canary',
    'tenerife' => 'Canary',
    'alicante' => 'Madrid',
    'cordoba es' => 'Madrid',
    'valladolid' => 'Madrid',
    'vigo' => 'Madrid',
    'gijon' => 'Madrid',
    'vitoria' => 'Madrid',
    'granada' => 'Madrid',
    'oviedo' => 'Madrid',
    'pamplona' => 'Madrid',
    'santander' => 'Madrid',
    'braga' => 'Lisbon',
    'coimbra' => 'Lisbon',
    'funchal' => 'Lisbon',
    'bologna' => 'Rome',
    'genoa' => 'Rome',
    'palermo' => 'Rome',
    'catania' => 'Rome',
    'bari' => 'Rome',
    'verona' => 'Rome',
    'messina' => 'Rome',
    'padua' => 'Rome',
    'trieste' => 'Rome',
    'brescia' => 'Rome',
    'parma' => 'Rome',
    'modena' => 'Rome',
    'reggio calabria' => 'Rome',
    'perugia' => 'Rome',
    'ravenna' => 'Rome',
    'livorno' => 'Rome',
    'cagliari' => 'Rome',
    'rimini' => 'Rome',
    'sassari' => 'Rome',
    'monza' => 'Rome',
    'bergamo' => 'Rome',
    'utrecht' => 'Amsterdam',
    'eindhoven' => 'Amsterdam',
    'tilburg' => 'Amsterdam',
    'groningen' => 'Amsterdam',
    'almere' => 'Amsterdam',
    'breda' => 'Amsterdam',
    'nijmegen' => 'Amsterdam',
    'apeldoorn' => 'Amsterdam',
    'arnhem' => 'Amsterdam',
    'haarlem' => 'Amsterdam',
    'ghent' => 'Brussels',
    'charleroi' => 'Brussels',
    'liege' => 'Brussels',
    'bruges' => 'Brussels',
    'namur' => 'Brussels',
    'leuven' => 'Brussels',
    'mons' => 'Brussels',
    'mechelen' => 'Brussels',
    'aalst' => 'Brussels',
    'graz' => 'Vienna',
    'linz' => 'Vienna',
    'salzburg' => 'Vienna',
    'innsbruck' => 'Vienna',
    'klagenfurt' => 'Vienna',
    'lausanne' => 'Zurich',
    'winterthur' => 'Zurich',
    'lucerne' => 'Zurich',
    'lugano' => 'Zurich',
    'biel' => 'Zurich',
    'thun' => 'Zurich',
    'st gallen' => 'Zurich',
    'aarhus' => 'Copenhagen',
    'odense' => 'Copenhagen',
    'aalborg' => 'Copenhagen',
    'esbjerg' => 'Copenhagen',
    'gothenburg' => 'Stockholm',
    'malmo' => 'Stockholm',
    'uppsala' => 'Stockholm',
    'linkoping' => 'Stockholm',
    'orebro' => 'Stockholm',
    'vasteras' => 'Stockholm',
    'helsingborg' => 'Stockholm',
    'norrkoping' => 'Stockholm',
    'jonkoping' => 'Stockholm',
    'umea' => 'Stockholm',
    'bergen' => 'Oslo',
    'trondheim' => 'Oslo',
    'stavanger' => 'Oslo',
    'kristiansand' => 'Oslo',
    'drammen' => 'Oslo',
    'fredrikstad' => 'Oslo',
    'tromso' => 'Oslo',
    'espoo' => 'Helsinki',
    'tampere' => 'Helsinki',
    'vantaa' => 'Helsinki',
    'turku' => 'Helsinki',
    'oulu' => 'Helsinki',
    'lahti' => 'Helsinki',
    'kuopio' => 'Helsinki',
    'jyvaskyla' => 'Helsinki',
    'pori' => 'Helsinki',
    'lappeenranta' => 'Helsinki',
    'wroclaw' => 'Warsaw',
    'lodz' => 'Warsaw',
    'gdansk' => 'Warsaw',
    'poznan' => 'Warsaw',
    'szczecin' => 'Warsaw',
    'bydgoszcz' => 'Warsaw',
    'lublin' => 'Warsaw',
    'katowice' => 'Warsaw',
    'bialystok' => 'Warsaw',
    'gdynia' => 'Warsaw',
    'czestochowa' => 'Warsaw',
    'sosnowiec' => 'Warsaw',
    'radom' => 'Warsaw',
    'torun' => 'Warsaw',
    'kielce' => 'Warsaw',
    'gliwice' => 'Warsaw',
    'zabrze' => 'Warsaw',
    'olsztyn' => 'Warsaw',
    'brno' => 'Prague',
    'ostrava' => 'Prague',
    'plzen' => 'Prague',
    'liberec' => 'Prague',
    'olomouc' => 'Prague',
    'usti nad labem' => 'Prague',
    'ceske budejovice' => 'Prague',
    'hradec kralove' => 'Prague',
    'pardubice' => 'Prague',
    'zlin' => 'Prague',
    'kladno' => 'Prague',
    'most' => 'Prague',
    'opava' => 'Prague',
    'frydek-mistek' => 'Prague',
    'debrecen' => 'Budapest',
    'szeged' => 'Budapest',
    'miskolc' => 'Budapest',
    'pecs' => 'Budapest',
    'gyor' => 'Budapest',
    'nyiregyhaza' => 'Budapest',
    'kecskemet' => 'Budapest',
    'szekesfehervar' => 'Budapest',
    'bratislava' => 'Bratislava',
    'kosice' => 'Bratislava',
    'presov' => 'Bratislava',
    'zilina' => 'Bratislava',
    'nitra' => 'Bratislava',
    'banska bystrica' => 'Bratislava',
    'trnava' => 'Bratislava',
    'cluj' => 'Bucharest',
    'timisoara' => 'Bucharest',
    'iasi' => 'Bucharest',
    'constanta' => 'Bucharest',
    'craiova' => 'Bucharest',
    'brasov' => 'Bucharest',
    'galati' => 'Bucharest',
    'ploiesti' => 'Bucharest',
    'oradea' => 'Bucharest',
    'braila' => 'Bucharest',
    'arad' => 'Bucharest',
    'sibiu' => 'Bucharest',
    'plovdiv' => 'Sofia',
    'varna' => 'Sofia',
    'burgas' => 'Sofia',
    'ruse' => 'Sofia',
    'stara zagora' => 'Sofia',
    'pleven' => 'Sofia',
    'sliven' => 'Sofia',
    'dobrich' => 'Sofia',
    'novi sad' => 'Belgrade',
    'nis' => 'Belgrade',
    'kragujevac' => 'Belgrade',
    'subotica' => 'Belgrade',
    'zrenjanin' => 'Belgrade',
    'pancevo' => 'Belgrade',
    'cacak' => 'Belgrade',
    'novi pazar' => 'Belgrade',
    'split' => 'Zagreb',
    'rijeka' => 'Zagreb',
    'osijek' => 'Zagreb',
    'zadar' => 'Zagreb',
    'pula' => 'Zagreb',
    'slavonski brod' => 'Zagreb',
    'karlovac' => 'Zagreb',
    'varazdin' => 'Zagreb',
    'sibenik' => 'Zagreb',
    'sisak' => 'Zagreb',
    'dubrovnik' => 'Zagreb',
    'maribor' => 'Ljubljana',
    'celje' => 'Ljubljana',
    'kranj' => 'Ljubljana',
    'velenje' => 'Ljubljana',
    'koper' => 'Ljubljana',
    'novo mesto' => 'Ljubljana',
    'banja luka' => 'Sarajevo',
    'tuzla' => 'Sarajevo',
    'zenica' => 'Sarajevo',
    'mostar' => 'Sarajevo',
    'bihac' => 'Sarajevo',
    'prijedor' => 'Sarajevo',
    'podgorica' => 'Podgorica',
    'niksic' => 'Podgorica',
    'pljevlja' => 'Podgorica',
    'bijelo polje' => 'Podgorica',
    'herceg novi' => 'Podgorica',
    'berane' => 'Podgorica',
    'budva' => 'Podgorica',
    'bar' => 'Podgorica',
    'ulcinj' => 'Podgorica',
    'bitola' => 'Skopje',
    'kumanovo' => 'Skopje',
    'prilep' => 'Skopje',
    'tetovo' => 'Skopje',
    'veles' => 'Skopje',
    'stip' => 'Skopje',
    'ohrid' => 'Skopje',
    'gostivar' => 'Skopje',
    'strumica' => 'Skopje',
    'durres' => 'Europe/Tirane',
    'vlore' => 'Europe/Tirane',
    'elbasan' => 'Europe/Tirane',
    'shkoder' => 'Europe/Tirane',
    'fier' => 'Europe/Tirane',
    'korce' => 'Europe/Tirane',
    'berat' => 'Europe/Tirane',
    'lushnje' => 'Europe/Tirane',
    'kavaje' => 'Europe/Tirane',
    'pristina' => 'Belgrade',
    'prizren' => 'Belgrade',
    'mitrovica' => 'Belgrade',
    'peja' => 'Belgrade',
    'gjakova' => 'Belgrade',
    'gjilan' => 'Belgrade',
    'ferizaj' => 'Belgrade',
    'tartu' => 'Tallinn',
    'narva' => 'Tallinn',
    'parnu' => 'Tallinn',
    'kohtla-jarve' => 'Tallinn',
    'viljandi' => 'Tallinn',
    'rakvere' => 'Tallinn',
    'sillamae' => 'Tallinn',
    'maardu' => 'Tallinn',
    'kuressaare' => 'Tallinn',
    'daugavpils' => 'Riga',
    'liepaja' => 'Riga',
    'jelgava' => 'Riga',
    'jurmala' => 'Riga',
    'ventspils' => 'Riga',
    'rezekne' => 'Riga',
    'valmiera' => 'Riga',
    'jekabpils' => 'Riga',
    'kaunas' => 'Vilnius',
    'klaipeda' => 'Vilnius',
    'siauliai' => 'Vilnius',
    'panevezys' => 'Vilnius',
    'alytus' => 'Vilnius',
    'marijampole' => 'Vilnius',
    'mazeikiai' => 'Vilnius',
    'jonava' => 'Vilnius',
    'utena' => 'Vilnius',
    'gomel' => 'Minsk',
    'mogilev' => 'Minsk',
    'vitebsk' => 'Minsk',
    'grodno' => 'Minsk',
    'brest by' => 'Minsk',
    'bobruisk' => 'Minsk',
    'baranovichi' => 'Minsk',
    'borisov' => 'Minsk',
    'pinsk' => 'Minsk',
    'orsha' => 'Minsk',
    'mozyr' => 'Minsk',
    'kharkiv' => 'Kyiv',
    'odessa' => 'Kyiv',
    'dnipro' => 'Kyiv',
    'donetsk' => 'Kyiv',
    'zaporizhzhia' => 'Kyiv',
    'lviv' => 'Kyiv',
    'kryvyi rih' => 'Kyiv',
    'mykolaiv' => 'Kyiv',
    'mariupol' => 'Kyiv',
    'luhansk' => 'Kyiv',
    'vinnytsia' => 'Kyiv',
    'simferopol' => 'Kyiv',
    'sevastopol' => 'Kyiv',
    'makiivka' => 'Kyiv',
    'poltava' => 'Kyiv',
    'chernihiv' => 'Kyiv',
    'cherkasy' => 'Kyiv',
    'sumy' => 'Kyiv',
    'khmelnytskyi' => 'Kyiv',
    'zhytomyr' => 'Kyiv',
    'chernivtsi' => 'Kyiv',
    'rivne' => 'Kyiv',
    'ternopil' => 'Kyiv',
    'ivano-frankivsk' => 'Kyiv',
    'lutsk' => 'Kyiv',
    'uzhhorod' => 'Kyiv',
    'chisinau' => 'Chisinau',
    'tiraspol' => 'Chisinau',
    'balti' => 'Chisinau',
    'bender' => 'Chisinau',
    'rybnitsa' => 'Chisinau',
    'cahul' => 'Chisinau',
    'ungheni' => 'Chisinau',
    'soroca' => 'Chisinau',
    'orhei' => 'Chisinau',
    
    # Additional Russian Cities
    'nizhny novgorod' => 'Moscow',
    'samara' => 'Samara',
    'omsk' => 'Omsk',
    'kazan' => 'Moscow',
    'chelyabinsk' => 'Yekaterinburg',
    'rostov-on-don' => 'Moscow',
    'ufa' => 'Yekaterinburg',
    'volgograd' => 'Moscow',
    'perm' => 'Yekaterinburg',
    'krasnoyarsk' => 'Krasnoyarsk',
    'saratov' => 'Moscow',
    'voronezh' => 'Moscow',
    'tolyatti' => 'Samara',
    'krasnodar' => 'Moscow',
    'izhevsk' => 'Samara',
    'ulyanovsk' => 'Moscow',
    'barnaul' => 'Krasnoyarsk',
    'irkutsk' => 'Irkutsk',
    'tyumen' => 'Yekaterinburg',
    'khabarovsk' => 'Vladivostok',
    'yaroslavl' => 'Moscow',
    'makhachkala' => 'Moscow',
    'tomsk' => 'Krasnoyarsk',
    'orenburg' => 'Yekaterinburg',
    'kemerovo' => 'Krasnoyarsk',
    'novokuznetsk' => 'Krasnoyarsk',
    'ryazan' => 'Moscow',
    'astrakhan' => 'Moscow',
    'penza' => 'Moscow',
    'kirov' => 'Moscow',
    'lipetsk' => 'Moscow',
    'tula' => 'Moscow',
    'cheboksary' => 'Moscow',
    'kaliningrad' => 'Kaliningrad',
    'bryansk' => 'Moscow',
    'kursk' => 'Moscow',
    'ivanovo' => 'Moscow',
    'magnitogorsk' => 'Yekaterinburg',
    'tver' => 'Moscow',
    'stavropol' => 'Moscow',
    'belgorod' => 'Moscow',
    'arkhangelsk' => 'Moscow',
    'vladimir' => 'Moscow',
    'sochi' => 'Moscow',
    'kurgan' => 'Yekaterinburg',
    'smolensk' => 'Moscow',
    'kaluga' => 'Moscow',
    'oryol' => 'Moscow',
    'cherepovets' => 'Moscow',
    'saransk' => 'Moscow',
    'vologda' => 'Moscow',
    'yakutsk' => 'Yakutsk',
    'murmansk' => 'Moscow',
    'tambov' => 'Moscow',
    'petrozavodsk' => 'Moscow',
    'kostroma' => 'Moscow',
    'novorossiysk' => 'Moscow',
    'yoshkar-ola' => 'Moscow',
    'taganrog' => 'Moscow',
    'syktyvkar' => 'Moscow',
    'nalchik' => 'Moscow',
    'nizhnekamsk' => 'Moscow',
    'dzerzhinsk' => 'Moscow',
    'orsk' => 'Yekaterinburg',
    'bratsk' => 'Irkutsk',
    'surgut' => 'Yekaterinburg',
    'angarsk' => 'Irkutsk',
    'petropavlovsk-kamchatsky' => 'Kamchatka',
    'yuzhno-sakhalinsk' => 'Sakhalin',
    'magadan' => 'Magadan',
    'chita' => 'Yakutsk',
    'blagoveshchensk' => 'Yakutsk',
    'komsomolsk-on-amur' => 'Vladivostok',
    'pskov' => 'Moscow',
    'velikiy novgorod' => 'Moscow',
    'rybinsk' => 'Moscow',
    'severodvinsk' => 'Moscow',
    'armavir' => 'Moscow',
    'syzran' => 'Moscow',
    
    # Additional Asian Cities
    'fukuoka' => 'Tokyo',
    'kobe' => 'Tokyo',
    'kawasaki' => 'Tokyo',
    'saitama' => 'Tokyo',
    'hiroshima' => 'Tokyo',
    'sendai' => 'Tokyo',
    'kitakyushu' => 'Tokyo',
    'chiba' => 'Tokyo',
    'sakai' => 'Tokyo',
    'niigata' => 'Tokyo',
    'hamamatsu' => 'Tokyo',
    'shizuoka' => 'Tokyo',
    'sagamihara' => 'Tokyo',
    'okayama' => 'Tokyo',
    'oita' => 'Tokyo',
    'kumamoto' => 'Tokyo',
    'kagoshima' => 'Tokyo',
    'funabashi' => 'Tokyo',
    'hachioji' => 'Tokyo',
    'kawaguchi' => 'Tokyo',
    'himeji' => 'Tokyo',
    'suginami' => 'Tokyo',
    'itabashi' => 'Tokyo',
    'nerima' => 'Tokyo',
    'fukuyama' => 'Tokyo',
    'hachinohe' => 'Tokyo',
    'kanazawa' => 'Tokyo',
    'nagano' => 'Tokyo',
    'wakayama' => 'Tokyo',
    'daegu' => 'Seoul',
    'incheon' => 'Seoul',
    'gwangju' => 'Seoul',
    'daejeon' => 'Seoul',
    'ulsan' => 'Seoul',
    'changwon' => 'Seoul',
    'goyang' => 'Seoul',
    'yongin' => 'Seoul',
    'seongnam' => 'Seoul',
    'bucheon' => 'Seoul',
    'ansan' => 'Seoul',
    'cheongju' => 'Seoul',
    'jeonju' => 'Seoul',
    'anyang' => 'Seoul',
    'cheonan' => 'Seoul',
    'namyangju' => 'Seoul',
    'pohang' => 'Seoul',
    'suwon' => 'Seoul',
    'hwaseong' => 'Seoul',
    'uijeongbu' => 'Seoul',
    'siheung' => 'Seoul',
    'paju' => 'Seoul',
    'gwangmyeong' => 'Seoul',
    'wonju' => 'Seoul',
    'pyeongtaek' => 'Seoul',
    'jinju' => 'Seoul',
    'yangsan' => 'Seoul',
    'gimhae' => 'Seoul',
    'jeju' => 'Seoul',
    'gumi' => 'Seoul',
    'mokpo' => 'Seoul',
    'chuncheon' => 'Seoul',
    'gangneung' => 'Seoul',
    'gyeongju' => 'Seoul',
    'kaohsiung' => 'Taipei',
    'taichung' => 'Taipei',
    'tainan' => 'Taipei',
    'hsinchu' => 'Taipei',
    'keelung' => 'Taipei',
    'chiayi' => 'Taipei',
    'changhua' => 'Taipei',
    'taoyuan' => 'Taipei',
    'yunlin' => 'Taipei',
    'miaoli' => 'Taipei',
    'nantou' => 'Taipei',
    'pingtung' => 'Taipei',
    'yilan' => 'Taipei',
    'hualien' => 'Taipei',
    'taitung' => 'Taipei',
    'davao' => 'Asia/Manila',
    'quezon city' => 'Asia/Manila',
    'caloocan' => 'Asia/Manila',
    'zamboanga' => 'Asia/Manila',
    'antipolo' => 'Asia/Manila',
    'pasig' => 'Asia/Manila',
    'taguig' => 'Asia/Manila',
    'cagayan de oro' => 'Asia/Manila',
    'paranaque' => 'Asia/Manila',
    'las pinas' => 'Asia/Manila',
    'makati' => 'Asia/Manila',
    'bacolod' => 'Asia/Manila',
    'iloilo' => 'Asia/Manila',
    'marikina' => 'Asia/Manila',
    'pasay' => 'Asia/Manila',
    'valenzuela' => 'Asia/Manila',
    'muntinlupa' => 'Asia/Manila',
    'general santos' => 'Asia/Manila',
    'malabon' => 'Asia/Manila',
    'dasmarinas' => 'Asia/Manila',
    'bacoor' => 'Asia/Manila',
    'san jose del monte' => 'Asia/Manila',
    'navotas' => 'Asia/Manila',
    'mandaluyong' => 'Asia/Manila',
    'puerto princesa' => 'Asia/Manila',
    'baguio' => 'Asia/Manila',
    'lapu-lapu' => 'Asia/Manila',
    'mandaue' => 'Asia/Manila',
    'angeles' => 'Asia/Manila',
    'naga' => 'Asia/Manila',
    'butuan' => 'Asia/Manila',
    'iligan' => 'Asia/Manila',
    'olongapo' => 'Asia/Manila',
    'tacloban' => 'Asia/Manila',
    'binan' => 'Asia/Manila',
    'santa rosa ph' => 'Asia/Manila',
    'imus' => 'Asia/Manila',
    'lipa' => 'Asia/Manila',
    'lucena' => 'Asia/Manila'
  }.freeze

  TIMEZONE_ABBREVIATIONS = {
    'pst' => 'Pacific Time (US & Canada)',
    'pdt' => 'Pacific Time (US & Canada)',
    'mst' => 'Mountain Time (US & Canada)',
    'mdt' => 'Mountain Time (US & Canada)',
    'cst' => 'Central Time (US & Canada)',
    'cdt' => 'Central Time (US & Canada)',
    'est' => 'Eastern Time (US & Canada)',
    'edt' => 'Eastern Time (US & Canada)',
    'gmt' => 'London',
    'utc' => 'UTC',
    'bst' => 'London',
    'cet' => 'Berlin',
    'cest' => 'Berlin',
    'jst' => 'Tokyo',
    'aest' => 'Sydney',
    'aedt' => 'Sydney',
    'ist' => 'New Delhi'
  }.freeze

  def parse(input)
    return nil if input.blank?
    
    input = input.downcase.strip
    
    parts = input.split(/\s+in\s+/, 2)
    return nil if parts.length != 2
    
    source_part = parts[0]
    target_part = parts[1]
    
    source_time, source_city = parse_source(source_part)
    return nil unless source_time && source_city
    
    target_cities = parse_targets(target_part)
    return nil if target_cities.empty?
    
    {
      source_time: source_time,
      source_city: source_city,
      target_cities: target_cities
    }
  end

  def convert_time(parsed_input)
    return nil unless parsed_input
    
    source_tz = get_timezone(parsed_input[:source_city])
    return nil unless source_tz
    
    source_time_in_tz = source_tz.parse(parsed_input[:source_time].strftime("%Y-%m-%d %H:%M:%S"))
    
    results = []
    
    all_cities = [parsed_input[:source_city]] + parsed_input[:target_cities]
    all_cities.uniq.each do |city|
      tz = get_timezone(city)
      next unless tz
      
      converted_time = source_time_in_tz.in_time_zone(tz)
      
      # Format city name properly - handle parentheses for country disambiguation
      formatted_city = if city.include?('(')
        parts = city.split(' (')
        city_part = parts[0].split.map(&:capitalize).join(' ')
        country_part = parts[1]&.chomp(')')&.split&.map(&:capitalize)&.join(' ')
        country_part ? "#{city_part} (#{country_part})" : city_part
      else
        city.split.map(&:capitalize).join(' ')
      end
      
      results << {
        city: formatted_city,
        time: converted_time,
        timezone: tz.name,
        offset: tz.formatted_offset,
        is_pm: converted_time.hour >= 12
      }
    end
    
    results.sort_by { |r| r[:time].utc_offset }
  end

  private

  def parse_source(source_part)
    time_match = source_part.match(/(\d{1,2}):?(\d{2})?\s*(am|pm)?/i)
    return [nil, nil] unless time_match
    
    hour = time_match[1].to_i
    minute = (time_match[2] || '0').to_i
    meridiem = time_match[3]&.downcase
    
    if meridiem == 'pm' && hour != 12
      hour += 12
    elsif meridiem == 'am' && hour == 12
      hour = 0
    elsif !meridiem && hour < 12
      hour = hour
    end
    
    city_part = source_part.sub(time_match[0], '').strip
    
    if city_part.empty?
      city_part = 'utc'
    end
    
    time = Time.zone.now.change(hour: hour, min: minute, sec: 0)
    
    [time, city_part]
  end

  def parse_targets(target_part)
    cities = []
    
    separators = /,|\s+and\s+|\s+&\s+/
    parts = target_part.split(separators)
    
    parts.each do |part|
      city = part.strip.downcase
      cities << city unless city.empty?
    end
    
    cities
  end

  def get_timezone(city_or_tz)
    city_or_tz = city_or_tz.downcase.strip
    
    # Check for country disambiguation first
    if CITY_COUNTRY_DISAMBIGUATION.key?(city_or_tz)
      ActiveSupport::TimeZone[CITY_COUNTRY_DISAMBIGUATION[city_or_tz]]
    elsif TIMEZONE_ABBREVIATIONS.key?(city_or_tz)
      ActiveSupport::TimeZone[TIMEZONE_ABBREVIATIONS[city_or_tz]]
    elsif CITY_TIMEZONE_MAP.key?(city_or_tz)
      ActiveSupport::TimeZone[CITY_TIMEZONE_MAP[city_or_tz]]
    elsif city_or_tz == 'utc'
      ActiveSupport::TimeZone['UTC']
    else
      ActiveSupport::TimeZone[city_or_tz.split.map(&:capitalize).join(' ')]
    end
  end
end